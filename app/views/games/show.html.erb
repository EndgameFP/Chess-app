<script>
	var prevpiece 
	function selectpiece(x,y){
		currenttile=$("#"+x+"-"+y);
		$('.selected').removeClass('selected');
		$("#"+x+"-"+y).addClass("selected")
		if (prevpiece && !currenttile.has("img").length ) {
			console.log(prevpiece)
			prevpiece.detach();	
			prevpiece.appendTo("#"+x+"-"+y);
			prevpiece=null
			$('.selected').removeClass('selected');
			//a move was placed so call ajax
			//$.ajax({ })
		}else{
			prevpiece = $("#"+x+"-"+y+" img")
		} 
	}
</script>

<div id="chessboard">
	<% tile_color = "white" %>
	<% for row in 1..8 %>
		<div class = "row">
		<% for col in 1..8 %>
			<div class = "tile <%=tile_color%>" id = "<%=row%>-<%=col%>"  onclick = "selectpiece(<%=row.to_s %>,<%=col.to_s %>)" > 
				<% if col < 8 %>
					<% tile_color == "white" ? (tile_color = "black") : (tile_color = "white") %>
				<% end %>
				<% @pieces.each do |piece| %>
					<% if piece.x_position == row && piece.y_position == col %>
						<%=  image_tag(piece.image, class: "img-responsive icon") %>				
					<% end %>
				<% end %>
			</div>
		<% end %> <!-- for col -->
		</div>
	<% end %> <!-- for row  -->
</div>
	

<div class="game-info pull-right">
	<ul>
		<li><%= @game.name %></li>
		<br />
		<% @user.each do |user| %>
			<% if user.id == @game.white_player_id %>
				<li>White Player: <%= user.email %></li><br />
			<% end %>
			<% if user.id == @game.black_player_id %>
				<li>Black Player: <%= user.email %></li>
			<% end %>
		<% end %>
	</ul>
</div>